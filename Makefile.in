SHELL = /bin/sh

prefix:=@prefix@
exec_prefix:=@exec_prefix@
datadir:=@datadir@
sysconfdir:=@sysconfdir@
sbindir:=@sbindir@
lsbindir:=@lsbindir@
datarootdir:=@datarootdir@

includedir:=@includedir@
mandir:=@mandir@
bindir:=@bindir@
libdir:=@libdir@

srcdir:=@srcdir@
top_srcdir:=@top_srcdir@
top_builddir:=@top_builddir@
ENSUREDIR:=${srcdir}/ensure-dir.sh
VPATH:=@srcdir@
# XXX LIBTOOL:=@LIBTOOL@
LIBTOOL:=./libtool
CC:=@CC@
INSTALL:=@INSTALL@
RANLIB:=@RANLIB@
YACC=@YACC@

BUILDTOP := .
CPPFLAGS := @CPPFLAGS@
CFLAGS := @CFLAGS@
X_CFLAGS := @X_CFLAGS@
ALL_CFLAGS := $(CFLAGS) $(X_CFLAGS) \
	-DSYSCONFDIR=\"$(sysconfdir)\" -DDATADIR=\"${datadir}\" \
	-I$(top_srcdir)/h -I$(BUILDTOP)/h $(CPPFLAGS)
LDFLAGS := @LDFLAGS@
LIBS := @LIBS@
HESIOD_LIBS :=@HESIOD_LIBS@
SERVER_LIBS := ${LIBZEPHYR} @LIBS@ -lcom_err

LIBZEPHYR_LIBS := @LIBZEPHYR_LIBS@
LIBICONV := @LIBICONV@
ZWGC_LIBX11 := @ZWGC_LIBX11@
X_EXTRA_LIBS := @X_EXTRA_LIBS@
TLIB := @TLIB@
REGEX_LIBS := @REGEX_LIBS@
ARES_LIBS := @ARES_LIBS@
X_LIBS := @X_LIBS@
SS_LIBS := @SS_LIBS@

LIBZEPHYR=${BUILDTOP}/lib/libzephyr.la
YFLAGS=-d

#default target
all:

dir := lib
include lib/Rules.mk

dir := server
include server/Rules.mk

dir := zhm
include zhm/Rules.mk

dir := zwgc
include zwgc/Rules.mk

dir := clients
include clients/Rules.mk

install:
	${ENSUREDIR} ${DESTDIR}${prefix} 755
	${ENSUREDIR} ${DESTDIR}${exec_prefix} 755
	${ENSUREDIR} ${DESTDIR}${bindir} 755
	${ENSUREDIR} ${DESTDIR}${libdir} 755
	${ENSUREDIR} ${DESTDIR}${datadir} 755
	${ENSUREDIR} ${DESTDIR}${datadir}/zephyr 755
	${ENSUREDIR} ${DESTDIR}${sysconfdir} 755
	${ENSUREDIR} ${DESTDIR}${sysconfdir}/zephyr/acl 755
	${ENSUREDIR} ${DESTDIR}${sbindir} 755
	${ENSUREDIR} ${DESTDIR}${includedir} 755
	${ENSUREDIR} ${DESTDIR}${includedir}/zephyr 755
	${ENSUREDIR} ${DESTDIR}${mandir} 755
	${ENSUREDIR} ${DESTDIR}${mandir}/man1 755
	${ENSUREDIR} ${DESTDIR}${mandir}/man3 755
	${ENSUREDIR} ${DESTDIR}${mandir}/man8 755
	${INSTALL} -m 644 ${srcdir}/h/zephyr/mit-copyright.h \
		${DESTDIR}${includedir}/zephyr
	${INSTALL} -m 644 ${srcdir}/h/zephyr/zephyr.h \
		${DESTDIR}${includedir}/zephyr
	${INSTALL} -m 644 h/zephyr/zephyr_err.h ${DESTDIR}${includedir}/zephyr

include Common.mk
