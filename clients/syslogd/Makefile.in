SHELL = /bin/sh

prefix=@prefix@
exec_prefix=@exec_prefix@
datadir=@datadir@
confdir=@confdir@
sbindir=@sbindir@

includedir=$(prefix)/include
mandir=$(prefix)/man
libdir=$(exec_prefix)/lib
bindir=$(exec_prefix)/bin

srcdir=@srcdir@
top_srcdir=@top_srcdir@
BUILDTOP=../..
VPATH=@srcdir@
CC=@CC@
INSTALL=@INSTALL@
SYSLOG_CONFPREFIX=n

DEBUG=-O
CFLAGS=$(DEBUG) -I$(srcdir) -I$(top_srcdir)/h -I$(BUILDTOP)/h \
	-DCONFPREFIX=\"$(SYSLOG_CONFPREFIX)\" @CPPFLAGS@
LDFLAGS=-L$(BUILDTOP)/lib/zephyr @ET_LDFLAGS@ @LDFLAGS@
LIBS=-lzephyr @LIBS@ -lcom_err @SLIB@

OBJS=	syslogd.o

all: syslogd

syslogd: $(OBJS) $(BUILDTOP)/lib/zephyr/libzephyr.a @ETDEP@
	$(CC) $(LDFLAGS) -o $@ $(OBJS) $(LIBS)

check:

install: syslogd
	$(INSTALL) -m 755 -c -s syslogd $(sbindir)
	$(INSTALL) -m 644 -c $(srcdir)/syslogd.8 $(mandir)/man8

clean:
	rm -f $(OBJS) syslogd

$(OBJS): $(top_srcdir)/h/sysdep.h $(BUILDTOP)/h/config.h
$(OBJS): $(BUILDTOP)/h/zephyr/zephyr.h $(BUILDTOP)/h/zephyr/zephyr_err.h

.PHONY: all check install clean

