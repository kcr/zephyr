/**/#	Copyright 1993 Massachusetts Institute of Technology
/**/#	For copying and distribution information, see the file
/**/#	"mit-copyright.h"
/**/#
/**/#	$Id: zephyr.rules,v 1.9 1994-11-11 20:11:21 ghudson Exp $

/* General system configuration */
#define KERBEROS	/* Has Kerberos installed */
#define HESIOD		/* Has Hesiod installed */

/* Other defines that one may wish to use */
#if 0
#define NO_IMAKE	/* Need to build imake */
#define NO_ET		/* Need to build com_err library */
#define NO_SS		/* Need to build ss library */
#endif

#ifndef UseSharedLibs
#define UseSharedLibs
#endif

#ifdef NO_IMAKE
D_IMAKE = $(PTOP)/util/imake
IMAKE = $(D_IMAKE)/imake
OTHER_IFLAGS = -DNO_IMAKE
Makefile Makefiles:: $(IMAKE)
#endif

#ifdef KERBEROS
CDEFS_KRB = -DKERBEROS
ZLIB_KRB = $(LIB_KRB)
#endif

#ifdef HESIOD
CDEFS_HES = -DHESIOD
ZLIB_HES = $(LIB_HES)
#endif

#ifdef NO_ET
D_ET = $(PTOP)/util/et
CDEFS_ET = -I$(D_ET)
#define EtLibs $(D_ET)/libcom_err.a
#endif

#ifdef NO_SS
D_UTIL = $(PTOP)/util
D_SS = $(D_UTIL)/ss
CDEFS_SS = -I$(D_UTIL)
#define SsLibs $(D_SS)/libss.a
#endif

ZPIDDIR = /etc/athena
ZETCDIR = $(ATHCONFDIR)/zephyr
ZLIBDIR = $(ATHLIBDIR)/zephyr
ZINCDIR = $(ATHINCDIR)/zephyr
ZACLDIR = $(ZETCDIR)/acl

BINC = $(PTOP)/h

ZLIB = $(PTOP)/lib/libzephyr.a
ZLIBDES = $(PTOP)/libdes/libdes.a
ZLIBS = $(ZLIB_KRB) $(LIB_ET) $(ZLIB_HES)
DYN_LIB = $(PTOP)/libdyn/libdyn.a

DEFINES = $(XDEFS) -I$(BINC) \
	$(CDEFS_KRB) $(CDEFS_HES) $(CDEFS_ET) $(CDEFS_SS) \
	$(MACHDEFS)

AnsiCC()

/* 
 * Supplemental rules
 */
#define make_err(name) \
error_table(name)							@@\
all:: concat3($(BINC)/zephyr/,name,.h)					@@\
$(OBJS): concat3($(BINC)/zephyr/,name,.h)				@@\
concat3($(BINC)/zephyr/,name,.h): concat2(name,.h)			@@\
	$(RM) $@; $(CP) concat2(name,.h) $@				@@\
clean::									@@\
	$(RM) concat3($(BINC)/zephyr/,name,.h)

#define zprogram(name,libs) \
SimpleProgram(name,$(OBJS) $(ZLIB),libs $(ZLIBS),$(ATHBINDIR)) @@\
create_depend($(SRCS))


#ifdef UseInstalled
ATHBINDIR = /mit/zephyr/@sys/bin
ATHLIBDIR = /mit/zephyr/@sys/lib
ATHINCDIR = /mit/zephyr/include
ATHMANDIR = /mit/zephyr/man

ZLIBDIR = /mit/zephyr/configs
ATHCONFDIR = $(ZLIBDIR)
ATHETCDIR = $(ATHBINDIR)
ATHRETCDIR = $(ATHBINDIR)

LDPATH = -L/usr/athena/lib/shared -L/usr/athena/lib
#endif
